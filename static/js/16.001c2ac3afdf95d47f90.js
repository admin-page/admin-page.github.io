webpackJsonp([16],{"1ByS":function(e,t){},"VXe/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("n5Qe"),o=a("7Tn/"),i={name:"ExportExcel",data:function(){return{listLoading:!0,exportParam:{fileName:"",autoWidth:!0,type:"xlsx"},tableData:[],multipleSelection:[]}},components:{Hints:a("LacG").a},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(l.a)(this.exportParam).then(function(t){var a=t.data;0===a.code&&(a.data.list.forEach(function(t){var a=t.id,l=t.name,o=t.sex,i=t.phone,n=t.education,r=t.hobby;e.tableData.push({id:a,name:l,sex:o,phone:i,education:n,hobby:r})}),e.listLoading=!1)}).catch(function(){e.listLoading=!1})},handleSelectionChange:function(e){this.multipleSelection=e},handleExport:function(){if(this.multipleSelection.length){var e={header:["编号","姓名","性别","手机","学历","爱好"],key:["id","name","sex","phone","education","hobby"],data:this.multipleSelection,autoWidth:this.exportParam.autoWidth,fileName:this.exportParam.fileName,bookType:this.exportParam.type};o.a.exportDataToExcel(e),this.$refs.multipleTable.clearSelection()}else this.$message.warning("请勾选要导出的数据项！")}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"export-excel-wrapper"},[a("Hints",[a("template",{slot:"hintName"},[e._v("JS-xlsx插件")]),e._v(" "),a("template",{slot:"hintInfo"},[a("p",[e._v("JS-xlsx：由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库，功能强大，支持xlsx、csv、txt等格式")]),e._v(" "),a("p",[e._v("github地址：访问 "),a("el-link",{attrs:{type:"success",href:"https://github.com/SheetJS/sheetjs",target:"_blank"}},[e._v("JS-xlsx")])],1)])],2),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{inline:!0,model:e.exportParam,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文件名:"}},[a("el-input",{attrs:{placeholder:"文件名"},model:{value:e.exportParam.fileName,callback:function(t){e.$set(e.exportParam,"fileName",t)},expression:"exportParam.fileName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"自动宽度:"}},[a("el-radio-group",{model:{value:e.exportParam.autoWidth,callback:function(t){e.$set(e.exportParam,"autoWidth",t)},expression:"exportParam.autoWidth"}},[a("el-radio",{attrs:{label:!0}},[e._v("自动")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("固定")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文件类型:"}},[a("el-select",{attrs:{placeholder:"文件类型"},model:{value:e.exportParam.type,callback:function(t){e.$set(e.exportParam,"type",t)},expression:"exportParam.type"}},[a("el-option",{attrs:{value:"xlsx",label:"xlsx"}}),e._v(" "),a("el-option",{attrs:{value:"csv",label:"csv"}}),e._v(" "),a("el-option",{attrs:{value:"txt",label:"txt"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary"},on:{click:e.handleExport}},[e._v("导出Excel")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",size:"medium"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"编号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sex",label:"性别",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"education",label:"学历",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"hobby",label:"爱好",align:"center",width:"300"}})],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(i,n,!1,function(e){a("1ByS")},null,null);t.default=r.exports}});
//# sourceMappingURL=16.001c2ac3afdf95d47f90.js.map