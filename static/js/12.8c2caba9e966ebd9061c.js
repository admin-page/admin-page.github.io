webpackJsonp([12],{"4x2S":function(e,t){},Hhlq:function(e,t){},S1Xx:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7Tn/"),l={name:"UploadExcel",methods:{handleLimit:function(){return this.$message.warning("Excel文件只支持单个上传!"),!1},handleChange:function(e){var t=e.raw;return!!t&&(this.isExcel(t)?void(this.isLimit1M(t)&&this.readFile(t)):(this.$message.warning("Excel文件只支持.xlsx, .xls, .csv格式!"),!1))},isLimit1M:function(e){var t=e.size/1024/1024<1;return!!t||(this.$message.warning("上传的Excel文件大小不能超过1M!"),!1)},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)},readFile:function(e){var t=this,a=new FileReader;a.onload=function(e){var a=e.target.result,l=s.a.readDataFromExcel(a,"array"),n=l.header,r=l.results;t.$emit("on-success",{header:n,results:r})},a.readAsArrayBuffer(e),a.onerror=function(e){t.$message.error("Excel文件读取出错!")},this.$refs.uploadExcel.clearFiles()}}},n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"upload-excel-wrapper"},[t("el-upload",{ref:"uploadExcel",attrs:{drag:"",action:"",accept:".xlsx, .xls, .csv",multiple:!1,"show-file-list":!1,"auto-upload":!1,limit:1,"on-exceed":this.handleLimit,"on-change":this.handleChange}},[t("i",{staticClass:"el-icon-upload"}),this._v(" "),t("div",{staticClass:"el-upload__text"},[this._v("将Excel文件拖到此处，或"),t("em",[this._v("点击上传")])])])],1)},staticRenderFns:[]};var r={name:"ImportExcel",data:function(){return{tableHeader:[],tableData:[]}},components:{UploadExcel:a("VU/8")(l,n,!1,function(e){a("4x2S")},null,null).exports,Hints:a("LacG").a},methods:{handleSuccess:function(e){var t=e.header,a=e.results;this.tableHeader=t,this.tableData=a}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"import-excel-wrapper"},[a("Hints",[a("template",{slot:"hintName"},[e._v("JS-xlsx插件")]),e._v(" "),a("template",{slot:"hintInfo"},[a("p",[e._v("JS-xlsx：由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库，功能强大，支持xlsx、csv、txt等格式")]),e._v(" "),a("p",[e._v("github地址：访问 "),a("el-link",{attrs:{type:"success",href:"https://github.com/SheetJS/sheetjs",target:"_blank"}},[e._v("JS-xlsx")])],1)])],2),e._v(" "),a("el-card",{attrs:{shadow:"always"}},[a("UploadExcel",{on:{"on-success":e.handleSuccess}}),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",size:"medium"}},e._l(e.tableHeader,function(e){return a("el-table-column",{key:e,attrs:{prop:e,label:e,align:"center"}})}),1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(r,i,!1,function(e){a("Hhlq")},null,null);t.default=c.exports}});
//# sourceMappingURL=12.8c2caba9e966ebd9061c.js.map