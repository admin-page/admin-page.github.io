webpackJsonp([3],{"2KxR":function(t,e){t.exports=function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!");return t}},"4WTo":function(t,e,i){var n=i("NWt+");t.exports=function(t,e){var i=[];return n(t,!1,i.push,i,e),i}},"7Doy":function(t,e,i){var n=i("EqjI"),s=i("7UMu"),a=i("dSzd")("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),n(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},"9Bbf":function(t,e,i){"use strict";var n=i("kM2E");t.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},"9C8M":function(t,e,i){"use strict";var n=i("evD5").f,s=i("Yobk"),a=i("xH/j"),r=i("+ZMJ"),o=i("2KxR"),l=i("NWt+"),h=i("vIB/"),c=i("EGZi"),u=i("bRrM"),d=i("+E39"),f=i("06OY").fastKey,m=i("LIJb"),p=d?"_s":"size",v=function(t,e){var i,n=f(e);if("F"!==n)return t._i[n];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,h){var c=t(function(t,n){o(t,c,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[p]=0,void 0!=n&&l(n,i,t[h],t)});return a(c.prototype,{clear:function(){for(var t=m(this,e),i=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];t._f=t._l=void 0,t[p]=0},delete:function(t){var i=m(this,e),n=v(i,t);if(n){var s=n.n,a=n.p;delete i._i[n.i],n.r=!0,a&&(a.n=s),s&&(s.p=a),i._f==n&&(i._f=s),i._l==n&&(i._l=a),i[p]--}return!!n},forEach:function(t){m(this,e);for(var i,n=r(t,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(t){return!!v(m(this,e),t)}}),d&&n(c.prototype,"size",{get:function(){return m(this,e)[p]}}),c},def:function(t,e,i){var n,s,a=v(t,e);return a?a.v=i:(t._l=a={i:s=f(e,!0),k:e,v:i,p:n=t._l,n:void 0,r:!1},t._f||(t._f=a),n&&(n.n=a),t[p]++,"F"!==s&&(t._i[s]=a)),t},getEntry:v,setStrong:function(t,e,i){h(t,e,function(t,i){this._t=m(t,e),this._k=i,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))},i?"entries":"values",!i,!0),u(e)}}},ALrJ:function(t,e,i){var n=i("+ZMJ"),s=i("MU5D"),a=i("sB3e"),r=i("QRG4"),o=i("oeOm");t.exports=function(t,e){var i=1==t,l=2==t,h=3==t,c=4==t,u=6==t,d=5==t||u,f=e||o;return function(e,o,m){for(var p,v,g=a(e),x=s(g),y=n(o,m,3),w=r(x.length),b=0,E=i?f(e,w):l?f(e,0):void 0;w>b;b++)if((d||b in x)&&(v=y(p=x[b],b,g),t))if(i)E[b]=v;else if(v)switch(t){case 3:return!0;case 5:return p;case 6:return b;case 2:E.push(p)}else if(c)return!1;return u?-1:h||c?c:E}}},BDhv:function(t,e,i){var n=i("kM2E");n(n.P+n.R,"Set",{toJSON:i("m9gC")("Set")})},HpRW:function(t,e,i){"use strict";var n=i("kM2E"),s=i("lOnJ"),a=i("+ZMJ"),r=i("NWt+");t.exports=function(t){n(n.S,t,{from:function(t){var e,i,n,o,l=arguments[1];return s(this),(e=void 0!==l)&&s(l),void 0==t?new this:(i=[],e?(n=0,o=a(l,arguments[2],2),r(t,!1,function(t){i.push(o(t,n++))})):r(t,!1,i.push,i),new this(i))}})}},IxjQ:function(t,e){},KuoK:function(t,e){},LIJb:function(t,e,i){var n=i("EqjI");t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},"NWt+":function(t,e,i){var n=i("+ZMJ"),s=i("msXi"),a=i("Mhyx"),r=i("77Pl"),o=i("QRG4"),l=i("3fs2"),h={},c={};(e=t.exports=function(t,e,i,u,d){var f,m,p,v,g=d?function(){return t}:l(t),x=n(i,u,e?2:1),y=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(a(g)){for(f=o(t.length);f>y;y++)if((v=e?x(r(m=t[y])[0],m[1]):x(t[y]))===h||v===c)return v}else for(p=g.call(t);!(m=p.next()).done;)if((v=s(p,x,m.value,e))===h||v===c)return v}).BREAK=h,e.RETURN=c},PKNs:function(t,e){},aoBj:function(t,e){},bRrM:function(t,e,i){"use strict";var n=i("7KvD"),s=i("FeBl"),a=i("evD5"),r=i("+E39"),o=i("dSzd")("species");t.exports=function(t){var e="function"==typeof s[t]?s[t]:n[t];r&&e&&!e[o]&&a.f(e,o,{configurable:!0,get:function(){return this}})}},bnGi:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("LacG"),s=i("lHA8"),a=i.n(s);function r(t){return"function"==typeof t||"[object Function]"===Object.prototype.toString.call(t)}function o(t,e,i){var n=t,s=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(function(t){return r(n[t])});if(!r(n[s]))return!1;do{if(n[s](e))return!0;if(n===i)return!1;n=n.parentNode}while(n);return!1}var l={name:"vue-drr",props:{active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},canDeactive:{type:Boolean,default:!0},w:{type:[Number],default:200},h:{type:[Number,String],default:28,validator:function(t){return"string"==typeof t?"auto"===t:t>=0}},ratio:{type:[Number,String]},contains:{type:Boolean,default:!1},minw:{type:Number,default:28,validator:function(t){return t>0}},minh:{type:Number,default:28,validator:function(t){return t>0}},angle:{type:Number,default:0,validator:function(t){return"number"==typeof t}},x:{type:Number,default:0,validator:function(t){return"number"==typeof t}},y:{type:Number,default:0,validator:function(t){return"number"==typeof t}},z:{type:[String,Number],default:"auto",validator:function(t){return"string"==typeof t?"auto"===t:t>=0}},handles:{type:Array,default:function(){return["n","e","s","w","nw","ne","se","sw"]},validator:function(t){var e=new a.a(["n","e","s","w","nw","ne","se","sw"]);return new a.a(t.filter(function(t){return e.has(t)})).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:function(t){return-1!==["x","y","both"].indexOf(t)}},grid:{type:Array,default:function(){return[1,1]}},parent:{type:Boolean,default:!1},overflowY:{type:String,default:""}},mounted:function(){var t=document.querySelector(".editor-mask")||document.documentElement;t.addEventListener("mousedown",this.deselect,!1),t.addEventListener("mousemove",this.handleMove,!1),t.addEventListener("mouseup",this.handleUp,!1),t.addEventListener("touchmove",this.handleMove,!1),t.addEventListener("touchend touchcancel",this.deselect,!1),t.addEventListener("touchstart",this.handleUp,!1),this.elmX=parseInt(this.$el.style.left),this.elmY=parseInt(this.$el.style.top),this.elmW=this.$el.offsetWidth||this.$el.clientWidth,this.elmH=this.$el.offsetHeight||this.$el.clientHeight,this.reviewDimensions()},beforeDestroy:function(){var t=document.querySelector(".editor-mask")||document.documentElement;t.removeEventListener("mousedown",this.deselect,!1),t.removeEventListener("mousemove",this.handleMove,!1),t.removeEventListener("mouseup",this.handleUp,!1),t.addEventListener("touchmove",this.handleMove,!1),t.addEventListener("touchend touchcancel",this.deselect,!1),t.addEventListener("touchstart",this.handleUp,!1)},data:function(){return{top:this.y,left:this.x,width:this.w,height:this.h,rotateAngle:this.angle,resizing:!1,dragging:!1,rotating:!1,enabled:this.active,handle:null,zIndex:this.z,parentW:9999,parentH:9999,mouseX:0,mouseY:0,lastMouseX:0,lastMouseY:0,mouseOffX:0,mouseOffY:0,elmX:0,elmY:0,elmW:0,elmH:0}},methods:{reviewDimensions:function(){if(this.minw>this.w&&(this.width=this.minw),this.minh>this.h&&(this.height=this.minh),this.parent){var t=parseInt(this.$el.parentNode.clientWidth,10),e=parseInt(this.$el.parentNode.clientHeight,10);this.parentW=t,this.parentH=e,this.w>this.parentW&&(this.width=t),this.h>this.parentH&&(this.height=e),this.x+this.w>this.parentW&&(this.width=t-this.x),this.y+this.h>this.parentH&&(this.height=e-this.y),this.elmW=this.width,this.elmH=this.height}this.$emit("resizing",this.left,this.top,this.width,this.height)},elmDown:function(t){var e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.dragHandle&&!o(e,this.dragHandle,this.$el)||this.dragCancel&&o(e,this.dragCancel,this.$el))return;this.reviewDimensions(),this.enabled||(this.enabled=!0,this.$emit("activated"),this.$emit("update:active",!0)),this.draggable&&(this.dragging=!0)}},deselect:function(t){-1!==t.type.indexOf("touch")?(this.mouseX=t.changedTouches[0].clientX,this.mouseY=t.changedTouches[0].clientY):(this.mouseX=t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouseY=t.pageY||t.clientY+document.documentElement.scrollTop),this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;var e=t.target||t.srcElement,i=new RegExp("z-handle-([nesw]{1, 2})","");this.$el.contains(e)||i.test(e.className)||this.enabled&&this.canDeactive&&(this.enabled=!1,this.$emit("deactivated"),this.$emit("update:active",!1))},handleResizeStart:function(t,e){this.handle=t,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.resizing=!0},handleDown:function(t,e){this.handle=t,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.resizing=!0},fillParent:function(t){var e=this;if(this.parent&&this.resizable&&this.maximize){var i=!1;window.requestAnimationFrame(function t(){i||window.requestAnimationFrame(t),"x"===e.axis?e.width===e.parentW&&0===e.left&&(i=!0):"y"===e.axis?e.height===e.parentH&&0===e.top&&(i=!0):"both"===e.axis&&e.width===e.parentW&&e.height===e.parentH&&0===e.top&&0===e.left&&(i=!0),"x"!==e.axis&&"both"!==e.axis||(e.width<e.parentW&&(e.width++,e.elmW++),e.left>0&&(e.left--,e.elmX--)),"y"!==e.axis&&"both"!==e.axis||(e.height<e.parentH&&(e.height++,e.elmH++),e.top>0&&(e.top--,e.elmY--)),e.$emit("resizing",e.left,e.top,e.width,e.height)})}},getOrigin:function(){var t=this.$el.getBoundingClientRect();return{x:(t.left+t.right)/2,y:(t.bottom+t.top)/2}},handleMove:function(t){var e=this.lastMouseX,i=this.lastMouseY,n=-1!==t.type.indexOf("touchmove");this.mouseX=n?t.touches[0].clientX:t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouseY=n?t.touches[0].clientY:t.pageY||t.clientY+document.documentElement.scrollTop;var s=this.mouseX-this.lastMouseX+this.mouseOffX,a=this.mouseY-this.lastMouseY+this.mouseOffY;this.mouseOffX=this.mouseOffY=0,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;var r=s,o=a;if(this.resizing)this.handle.indexOf("n")>=0&&(this.elmH-o<this.minh?this.mouseOffY=o-(a=this.elmH-this.minh):this.parent&&this.elmY+o<0&&(this.mouseOffY=o-(a=-this.elmY)),this.elmY+=a,this.elmH-=a),this.handle.indexOf("s")>=0&&(this.elmH+o<this.minh?this.mouseOffY=o-(a=this.minh-this.elmH):this.parent&&this.elmY+this.elmH+o>this.parentH&&(this.mouseOffY=o-(a=this.parentH-this.elmY-this.elmH)),this.elmH+=a),this.handle.indexOf("w")>=0&&(this.elmW-r<this.minw?this.mouseOffX=r-(s=this.elmW-this.minw):this.parent&&this.elmX+r<0&&(this.mouseOffX=r-(s=-this.elmX)),this.elmX+=s,this.elmW-=s),this.handle.indexOf("e")>=0&&(this.elmW+r<this.minw?this.mouseOffX=r-(s=this.minw-this.elmW):this.parent&&this.elmX+this.elmW+r>this.parentW&&(this.mouseOffX=r-(s=this.parentW-this.elmX-this.elmW)),this.elmW+=s),this.left=Math.round(this.elmX/this.grid[0])*this.grid[0],this.top=Math.round(this.elmY/this.grid[1])*this.grid[1],this.width=Math.round(this.elmW/this.grid[0])*this.grid[0],this.height=Math.round(this.elmH/this.grid[1])*this.grid[1],this.$emit("resizing",this.left,this.top,this.width,this.height);else if(this.dragging)this.parent&&(this.elmX+r<0?this.mouseOffX=r-(s=-this.elmX):this.elmX+this.elmW+r>this.parentW&&(this.mouseOffX=r-(s=this.parentW-this.elmX-this.elmW)),this.elmY+o<0?this.mouseOffY=o-(a=-this.elmY):this.elmY+this.elmH+o>this.parentH&&(this.mouseOffY=o-(a=this.parentH-this.elmY-this.elmH))),this.elmX+=s,this.elmY+=a,"x"!==this.axis&&"both"!==this.axis||(this.left=Math.round(this.elmX/this.grid[0])*this.grid[0]),"y"!==this.axis&&"both"!==this.axis||(this.top=Math.round(this.elmY/this.grid[1])*this.grid[1]),this.$emit("dragging",this.left,this.top);else if(this.rotating){var l=this.getOrigin(),h=Math.atan2(i-l.y,e-l.x),c=Math.atan2(this.mouseY-l.y,this.mouseX-l.x);this.rotateAngle+=Math.round(180*(c-h)/Math.PI),this.$emit("rotating",this.rotateAngle)}},handleUp:function(t){-1!==t.type.indexOf("touch")&&(this.lastMouseX=t.changedTouches[0].clientX,this.lastMouseY=t.changedTouches[0].clientY),this.handle=null,this.resizing&&(this.resizing=!1,this.$emit("resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,this.$emit("dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,this.$emit("rotatestop",this.rotateAngle)),this.elmX=this.left,this.elmY=this.top}},computed:{style:function(){return{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px",transform:"rotate("+this.rotateAngle+"deg)",zIndex:this.zIndex,overflowY:this.overflowY,overflowX:""}}},watch:{active:function(t){this.enabled=t},x:function(t){this.left=t,this.elmX=t},y:function(t){this.top=t,this.elmY=t},z:function(t){(t>=0||"auto"===t)&&(this.zIndex=t)},w:function(t){this.width=t,this.elmW=t},h:function(t){this.height=t,this.elmH=t},angle:function(t){this.rotateAngle=t}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"z-drr-container",class:{"z-draggable":t.draggable,"z-resizable":t.resizable,"z-rotatable":t.rotatable,"z-active":t.enabled,"z-dragging":t.dragging,"z-resizing":t.resizing,"z-rotating":t.rotating},style:t.style,on:{mousedown:t.elmDown}},[t.rotatable?i("div",{staticClass:"z-rotateable-handle",style:{display:t.enabled?"block":"none"},on:{touchstart:function(e){return e.preventDefault(),e.stopPropagation(),t.elmDown(e)},mousedown:function(e){e.stopPropagation(),e.preventDefault(),t.rotating=!0},dblclick:t.fillParent}}):t._e(),t._v(" "),t._l(t.handles,function(e){return t.resizable?i("div",{key:e,staticClass:"z-resizeable-handle",class:"z-handle-"+e,style:{display:t.enabled?"block":"none"},on:{touchstart:function(i){return i.stopPropagation(),i.preventDefault(),t.handleDown(e,i)},mousedown:function(i){return i.stopPropagation(),i.preventDefault(),t.handleResizeStart(e,i)}}}):t._e()}),t._v(" "),t._t("default")],2)},staticRenderFns:[]};var c=i("VU/8")(l,h,!1,function(t){i("IxjQ")},"data-v-473f682e",null).exports,u={name:"ElementDrr",props:{element:{type:Object,default:function(){}},handles:{type:Array,default:function(){return["n","e","s","w","nw","ne","se","sw"]}}},watch:{element:{handler:function(t){var e=this;this.$nextTick(function(){e.updateHeight()})},deep:!0}},components:{VueDrr:c},methods:{updateHeight:function(){var t=this;if("text"===this.element.type){var e=this.$el;this.$nextTick(function(){var i=Math.ceil(e.parentNode.getBoundingClientRect().height),n=Math.ceil(e.querySelector(".image-rich-text").getBoundingClientRect().height);t.element.y+n>=i&&(t.element.y=i-n),e.style.height=n+"px",t.element.h=n})}},handleDragStop:function(t,e){this.element.x===t&&this.element.y===e||(this.element.x=t,this.element.y=e)},handleResizing:function(){"text"===this.element.type&&this.updateHeight()},handleResizeStop:function(t,e,i,n){this.element.x===t&&this.element.y===e&&this.element.w===i&&this.element.h===n||(this.element.x=t,this.element.y=e,this.element.w=i,"text"===this.element.type?this.updateHeight():this.element.h=n)},handleDeactivate:function(){this.element.active=!1},handleActivated:function(){this.element.active=!0,this.$emit("updateActiveEle",this.element)}}},d={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("VueDrr",{staticClass:"element-drr-wrapper",attrs:{x:t.element.x,y:t.element.y,w:t.element.w,h:t.element.h,handles:t.handles,active:t.element.active,minw:80,minh:18,parent:!0,rotatable:!1},on:{dragstop:t.handleDragStop,resizing:t.handleResizing,resizestop:t.handleResizeStop,deactivated:t.handleDeactivate,activated:t.handleActivated}},[t._t("default")],2)},staticRenderFns:[]};var f=i("VU/8")(u,d,!1,function(t){i("aoBj")},null,null).exports;i("mvHQ");var m={name:"ImageRichText",data:function(){return{innerText:this.value.replace(/\n/g,"<br>")}},props:{value:{type:String,default:"请输入文本"},element:{type:Object,default:function(){return{style:{}}}},activeEleText:{type:Object,default:function(){}}},watch:{value:function(t){this.innerText=t}},methods:{emitInput:function(t){this.$emit("input",t.target.innerHTML),this.keepCursorLast(t)},handlePaste:function(t){this.$emit("input",function(t){function e(t){var e=function(t){return t.replace(/<(\/?)p>/g,"<$1div>")}(t).replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=e.split(/\r\n|\r|\n/);return i?i.map(function(t){return t.length>0?"<div>"+t+"</div>":"<div><br></div>"}).join(""):e}var i="",n=" ".repeat(2);if(t.preventDefault(),t.clipboardData)i=(t.originalEvent||t).clipboardData.getData("text/plain").replace(/\t/g,n),document.execCommand("insertHtml",!1,e(i));else if(window.clipboardData)if(i=window.clipboardData.getData("Text").replace(/\t/g,n),document.selection)document.selection.createRange().pasteHTML(e(i));else if(window.getSelection){var s=window.getSelection().getRangeAt(0),a=document.createElement("span");a.innerHTML="&#FEFF;",s.deleteContents(),s.insertNode(a);var r=document.body.createTextRange();r.moveToElementText(a),a.parentNode.removeChild(a),r.pasteHTML(e(i)),r.collapse(!1),r.select()}return e(i)}(t)),this.keepCursorLast(t)},keepCursorLast:function(t){this.$nextTick(function(){!function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var i=document.selection.createRange();i.moveToElementText(t),i.collapse(!1),i.select()}}(t.target)})},handleFocus:function(){this.activeEleText.active=!0}}},p={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"image-rich-text",style:t.element.style,attrs:{spellcheck:"false",contenteditable:"true"},domProps:{innerHTML:t._s(t.innerText)},on:{focus:t.handleFocus,keydown:function(t){return t.stopPropagation()},keyup:function(e){return e.stopPropagation(),t.emitInput(e)},paste:function(e){return t.handlePaste(e)},click:function(t){t.stopPropagation()}}})},staticRenderFns:[]};var v=i("VU/8")(m,p,!1,function(t){i("PKNs")},null,null).exports,g=[{value:"黑体"},{value:"宋体"},{value:"仿宋"},{value:"楷体"},{value:"隶书"},{value:"微软雅黑"},{value:"方正姚体"}],x=[{value:"12px"},{value:"14px"},{value:"16px"},{value:"18px"},{value:"24px"},{value:"32px"},{value:"48px"}],y={name:"TextSetting",data:function(){return{fontFamilyData:g,fontSizeData:x}},props:{activeEleText:{type:Object,default:function(){}}},computed:{fontWeight:function(){return 400!=+this.activeEleText.style.fontWeight}},watch:{activeEleText:{handler:function(t){this.activeEleText.style.lineHeight=t.style.fontSize},deep:!0}},components:{ImageRichText:v},methods:{setFontWeight:function(){400==+this.activeEleText.style.fontWeight?this.activeEleText.style.fontWeight=600:this.activeEleText.style.fontWeight=400},handleCommand:function(t){this.activeEleText.style.textAlign=t},setAlignActive:function(t){return this.activeEleText.style.textAlign===t?{backgroundColor:"#409eff",color:"#fff"}:{backgroundColor:"",color:"#333"}},textBecomeImg:function(t){var e=document.createElement("canvas");e.width=t.w,e.height=t.h;var i=e.getContext("2d");i.fillStyle=t.style.backgroundColor||"transparent",i.fillRect(0,0,e.width,e.height),i.fillStyle=t.style.color,i.font=t.style.fontWeight+" "+t.style.fontSize+" "+t.style.fontFamily,i.textBaseline="top",i.textAlign=t.style.textAlign;for(var n=t.text.split(""),s="",a=[],r=e.width-16,o=0;o<n.length;o++)i.measureText(s).width<r&&i.measureText(s+n[o]).width<=r?s+=n[o]:(a.push(s),s=n[o]);a.push(s);var l=void 0;"left"===i.textAlign?l=8:"center"===i.textAlign?l=r/2:"right"===i.textAlign&&(l=r);for(var h=0;h<a.length;h++)i.fillText(a[h],l,parseInt(t.style.fontSize)*h+4,r);return e.toDataURL("image/png")},downloadImage:function(){var t=function(t){for(var e=window.atob(t.split(",")[1]),i=[],n=0;n<e.length;n++)i.push(e.charCodeAt(n));return new Blob([new Uint8Array(i)],{type:"image/png"})}(this.textBecomeImg(this.activeEleText)),e=document.createElement("a");document.createEvent("HTMLEvents").initEvent("click",!0,!0),e.download="image.png",e.href=URL.createObjectURL(t),e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}},w={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"text-setting-wrapper"},[i("el-form",{attrs:{"label-width":"70px"}},[i("el-form-item",{attrs:{label:"文本"}},[i("ImageRichText",{staticClass:"text-editable",attrs:{activeEleText:t.activeEleText},model:{value:t.activeEleText.text,callback:function(e){t.$set(t.activeEleText,"text",e)},expression:"activeEleText.text"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"字体"}},[i("el-select",{attrs:{size:"small"},model:{value:t.activeEleText.style.fontFamily,callback:function(e){t.$set(t.activeEleText.style,"fontFamily",e)},expression:"activeEleText.style.fontFamily"}},t._l(t.fontFamilyData,function(t){return i("el-option",{key:t.value,style:{fontFamily:t.value},attrs:{label:t.value,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"字号"}},[i("el-select",{attrs:{size:"small"},model:{value:t.activeEleText.style.fontSize,callback:function(e){t.$set(t.activeEleText.style,"fontSize",e)},expression:"activeEleText.style.fontSize"}},t._l(t.fontSizeData,function(t){return i("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"颜色"}},[i("div",{staticClass:"color-box"},[i("i",{staticClass:"vue-sys-icon-wenzise color-icon",style:{color:t.activeEleText.color}}),t._v(" "),i("el-color-picker",{model:{value:t.activeEleText.style.color,callback:function(e){t.$set(t.activeEleText.style,"color",e)},expression:"activeEleText.style.color"}})],1),t._v(" "),i("div",{staticClass:"color-box"},[i("i",{staticClass:"vue-sys-icon-beijingse color-icon icon-bg",style:{color:t.activeEleText.backgroundColor}}),t._v(" "),i("el-color-picker",{model:{value:t.activeEleText.style.backgroundColor,callback:function(e){t.$set(t.activeEleText.style,"backgroundColor",e)},expression:"activeEleText.style.backgroundColor"}})],1),t._v(" "),i("div",{staticClass:"style-box"},[i("span",{class:["style-item",t.fontWeight?"active":""],on:{click:t.setFontWeight}},[i("i",{staticClass:"vue-sys-icon-jiacu style-icon"})]),t._v(" "),i("div",{staticClass:"style-item"},[i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("i",{staticClass:"vue-sys-icon-duiqi style-icon"}),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{style:t.setAlignActive("left"),attrs:{command:"left"}},[t._v("左对齐")]),t._v(" "),i("el-dropdown-item",{style:t.setAlignActive("center"),attrs:{command:"center"}},[t._v("居中")]),t._v(" "),i("el-dropdown-item",{style:t.setAlignActive("right"),attrs:{command:"right"}},[t._v("右对齐")])],1)],1)],1)])]),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.downloadImage}},[t._v("文本生成图片")])],1)],1)],1)},staticRenderFns:[]};var b=i("VU/8")(y,w,!1,function(t){i("zcku")},null,null).exports,E=i("yWvC"),_={name:"ImageSynthesizer",components:{Hints:n.a,ElementDrr:f,ImageRichText:v,TextSetting:b,UploadImage:E.a},data:function(){return{container:{width:0,height:0,bgImageSrc:"./static/img/crop-image.jpg"},elements:[],activeEle:{},eleNum:0}},computed:{containerStyle:function(){return{width:this.container.width+"px",height:this.container.height+"px",backgroundImage:"url('"+this.container.bgImageSrc+"')"}},activeEleText:function(){if("text"===this.activeEle.type)return this.activeEle}},created:function(){this.getDragContainerSize(1920,1200),this.addText(),this.addImage({active:!1,src:"./static/img/add-image.jpeg",size:53248,width:132,height:132})},methods:{dragHandles:function(t){if("text"===t)return["e","w"]},elementZIndex:function(t){var e=1;switch(t){case"text":e=3;break;case"image":e=2}return{zIndex:e}},handleSuccess:function(t){var e=this;this.container.bgImageSrc=t;var i=new Image;i.src=t,i.onload=function(){e.getDragContainerSize(i.width,i.height)}},getImageSize:function(t,e,i,n){var s=0,a=0;if(t>e)if(t>=i){var r=e*(i/t);r>=i?(s=t*(n/e),a=n):(s=i,a=r)}else s=t,a=e;else e>=n?(s=t*(n/e),a=n):(s=t,a=e);return{width:s,height:a}},getDragContainerSize:function(t,e){var i=this.getImageSize(t,e,850,550);this.container.width=i.width,this.container.height=i.height},addText:function(){var t={active:!0,text:"请输入文本",type:"text",tag:"text_"+ ++this.eleNum,x:160,y:100,w:180,h:36,style:{textAlign:"left",lineHeight:"24px",fontSize:"24px",fontFamily:"微软黑体",fontWeight:400,color:"#f70707",backgroundColor:"",overflow:"hidden"}};this.elements.length>4?this.$message.warning("图片上最多叠加5个元素！"):(this.elements.push(t),this.updateActiveEle(t))},addImage:function(t){var e=++this.eleNum,i={active:t.active,type:"image",tag:"image_"+e,x:490,y:100,w:parseInt(t.width),h:parseInt(t.height),src:t.src,size:t.size};this.elements.length>4?this.$message.warning("图片上最多叠加5个元素！"):(this.elements.push(i),t.active&&this.updateActiveEle(i))},handleAddImage:function(t){var e=this,i=t.replace("data:image/jpeg;base64,","").length,n=parseInt(i-i/8*2),s=new Image;s.src=t,s.onload=function(){var i=e.getImageSize(s.width,s.height,parseInt(e.container.width/4),parseInt(e.container.height/4));e.addImage({active:!0,src:t,size:n,width:i.width,height:i.height})}},updateActiveEle:function(t){this.activeEle=t},deleteActiveEle:function(){var t=this,e=this.elements.filter(function(e){return e.tag!==t.activeEle.tag});this.$nextTick(function(){t.elements=e}),this.updateActiveEle({})}}},z={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-synthesizer"},[i("Hints",[i("template",{slot:"hintName"},[t._v("图片合成")]),t._v(" "),i("template",{slot:"hintInfo"},[i("p",[t._v("基于VueDRR拖拽功能，在其上通过叠加图片、文字等，实现图片的叠加伪合成功能")]),t._v(" "),i("p",[t._v("VueDRR：基于vue-draggable-resizable的vue组件，可以实现拖动、拉伸和旋转功能")])])],2),t._v(" "),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:16}},[i("el-card",{attrs:{shadow:"always"}},[i("div",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v("合成区域")]),t._v(" "),i("div",{staticClass:"box-wrapper"},[i("div",{staticClass:"drag-container",style:t.containerStyle},t._l(t.elements,function(e,n){return i("ElementDrr",{key:n,style:t.elementZIndex(e.type),attrs:{element:e,handles:t.dragHandles(e.type)},on:{updateActiveEle:t.updateActiveEle}},["image"===e.type?i("img",{attrs:{src:e.src,draggable:"false"}}):t._e(),t._v(" "),"text"===e.type?i("ImageRichText",{attrs:{element:e,activeEleText:t.activeEleText},model:{value:e.text,callback:function(i){t.$set(e,"text",i)},expression:"item.text"}}):t._e()],1)}),1)])])],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-card",{attrs:{shadow:"always"}},[i("div",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v("设置区域")]),t._v(" "),i("div",{staticClass:"content-box"},[i("el-form",{staticClass:"form-wrapper",attrs:{"label-width":"70px"}},[i("el-form-item",{attrs:{label:"选择底图"}},[i("UploadImage",{attrs:{btnName:"选择底图"},on:{"on-success":t.handleSuccess}})],1),t._v(" "),i("el-form-item",{attrs:{label:"添加文本"}},[i("el-button",{on:{click:t.addText}},[t._v("添加文本")])],1),t._v(" "),i("el-form-item",{attrs:{label:"添加图片"}},[i("UploadImage",{on:{"on-success":t.handleAddImage}})],1),t._v(" "),i("el-form-item",{attrs:{label:"删除元素"}},[i("el-button",{attrs:{type:"danger"},on:{click:t.deleteActiveEle}},[t._v("删除元素")])],1)],1),t._v(" "),"text"===t.activeEle.type?i("TextSetting",{attrs:{activeEleText:t.activeEleText}}):t._e()],1)])],1)],1)],1)},staticRenderFns:[]};var T=i("VU/8")(_,z,!1,function(t){i("KuoK")},null,null);e.default=T.exports},ioQ5:function(t,e,i){i("HpRW")("Set")},lHA8:function(t,e,i){t.exports={default:i("pPW7"),__esModule:!0}},m9gC:function(t,e,i){var n=i("RY/4"),s=i("4WTo");t.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return s(this)}}},mvHQ:function(t,e,i){t.exports={default:i("qkKv"),__esModule:!0}},oNmr:function(t,e,i){i("9Bbf")("Set")},oeOm:function(t,e,i){var n=i("7Doy");t.exports=function(t,e){return new(n(t))(e)}},pPW7:function(t,e,i){i("M6a0"),i("zQR9"),i("+tPU"),i("ttyz"),i("BDhv"),i("oNmr"),i("ioQ5"),t.exports=i("FeBl").Set},qkKv:function(t,e,i){var n=i("FeBl"),s=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},qo66:function(t,e,i){"use strict";var n=i("7KvD"),s=i("kM2E"),a=i("06OY"),r=i("S82l"),o=i("hJx8"),l=i("xH/j"),h=i("NWt+"),c=i("2KxR"),u=i("EqjI"),d=i("e6n0"),f=i("evD5").f,m=i("ALrJ")(0),p=i("+E39");t.exports=function(t,e,i,v,g,x){var y=n[t],w=y,b=g?"set":"add",E=w&&w.prototype,_={};return p&&"function"==typeof w&&(x||E.forEach&&!r(function(){(new w).entries().next()}))?(w=e(function(e,i){c(e,w,t,"_c"),e._c=new y,void 0!=i&&h(i,g,e[b],e)}),m("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in E&&(!x||"clear"!=t)&&o(w.prototype,t,function(i,n){if(c(this,w,t),!e&&x&&!u(i))return"get"==t&&void 0;var s=this._c[t](0===i?0:i,n);return e?this:s})}),x||f(w.prototype,"size",{get:function(){return this._c.size}})):(w=v.getConstructor(e,t,g,b),l(w.prototype,i),a.NEED=!0),d(w,t),_[t]=w,s(s.G+s.W+s.F,_),x||v.setStrong(w,t,g),w}},ttyz:function(t,e,i){"use strict";var n=i("9C8M"),s=i("LIJb");t.exports=i("qo66")("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(s(this,"Set"),t=0===t?0:t,t)}},n)},"xH/j":function(t,e,i){var n=i("hJx8");t.exports=function(t,e,i){for(var s in e)i&&t[s]?t[s]=e[s]:n(t,s,e[s]);return t}},yWvC:function(t,e,i){"use strict";var n=i("pFYg"),s=i.n(n),a={name:"UploadImage",props:{btnName:{type:String,default:"选择图片"}},methods:{handleChange:function(t){var e=t.raw;return!!e&&(this.isImage(e)?void(this.isLimit5M(e)&&this.readImage(e)):(this.$message.warning("图片只支持.jpg, .png, .bmp, .jpeg, .webp格式!"),!1))},isLimit5M:function(t){var e=t.size/1024/1024<5;return!!e||(this.$message.warning("上传的图片大小不能超过5M!"),!1)},isImage:function(t){return/\.(jpg|png|bmp|jpeg|webp)$/.test(t.name)},readImage:function(t){var e=this,i=new FileReader;i.onload=function(t){var i=void 0;i="object"===s()(t.target.result)?window.URL.createObjectURL(new Blob([t.target.result])):t.target.result,e.$emit("on-success",i)},i.readAsDataURL(t),i.onerror=function(t){e.$message.error("图片读取出错!")},this.$refs.uploadImage.clearFiles()}}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-upload",{ref:"uploadImage",staticClass:"upload-image-wrapper",attrs:{action:"",accept:".jpg, .png, .bmp, .jpeg, .webp",multiple:!1,"show-file-list":!1,"auto-upload":!1,"on-change":this.handleChange}},[e("el-button",{attrs:{size:"small",type:"primary"}},[this._v(this._s(this.btnName))])],1)},staticRenderFns:[]},o=i("VU/8")(a,r,!1,null,null,null);e.a=o.exports},zcku:function(t,e){}});
//# sourceMappingURL=3.708f9683d6e1e3756e2f.js.map